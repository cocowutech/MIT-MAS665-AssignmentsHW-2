<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Adaptive Reading</title>
    <!--
    READING MODULE FRONTEND DOCUMENTATION
    =====================================
    
    This file implements the frontend interface for the adaptive reading assessment module.
    It provides a complete reading evaluation system with passages, multiple choice questions,
    and real-time feedback integration with the backend API.
    
    BACKEND API INTEGRATION:
    - POST /auth/token: User authentication
    - POST /read/start: Initialize new reading session
    - POST /read/answer: Submit reading answer for evaluation
    - POST /read/next: Get next question in current session
    - GET /auth/me: Validate current user token
    
    KEY FEATURES:
    - Adaptive difficulty progression based on performance
    - Multiple choice questions with immediate feedback
    - Reading comprehension assessment
    - Session management with progress tracking
    - Guest user support for testing
    
    BROWSER COMPATIBILITY:
    - Modern browsers with ES2020 support
    - Responsive design for mobile and desktop
    
    WORKFLOW:
    1. User logs in (guest/any for testing)
    2. Starts reading session with initial CEFR level
    3. Reads passage and answers multiple choice questions
    4. Receives immediate feedback and adaptive level adjustment
    5. Continues to next question or finishes session
    -->
    
    <!-- Shared CSS -->
    <link rel="stylesheet" href="../shared/css/base.css">
    <link rel="stylesheet" href="../shared/css/components.css">
    <!-- Module-specific CSS -->
    <link rel="stylesheet" href="styles.css">
    <!-- Shared JavaScript -->
    <script src="../shared/js/auth.js?v=20251009"></script>
    <script src="../shared/js/api.js?v=20251009"></script>
    <!-- Module-specific JavaScript -->
    <script src="read.js?v=20251009"></script>
</head>
<body>
    <div class="container">
        <!-- Header with navigation and auth state -->
        <div class="header">
            <h1>Adaptive Reading Module</h1>
            <div class="small">
                <a href="/app">Home</a> · 
                <span id="authState">Logged out</span> 
                <a href="/app" id="loginLink">Login</a>
            </div>
        </div>

        <!-- Back navigation card -->
        <div class="card">
            <button onclick="window.location.href = '/app/';">← Back</button>
        </div>

        <div id="status" class="small"></div>

        <!-- Login Form -->
        <div id="login-card" class="card">
            <h2>Login</h2>
            <form id="loginForm">
                <div class="row">
                    <div>
                        <label for="username">Username</label>
                        <input id="username" type="text" placeholder="username" value="guest" required>
                    </div>
                    <div>
                        <label for="password">Password</label>
                        <input id="password" type="password" placeholder="password" value="any" required>
                    </div>
                </div>
                <div style="margin-top:12px">
                    <button type="submit">Login</button>
                </div>
            </form>
        </div>

        <!-- Main Interface -->
        <div id="session-card" class="hidden">
            <div class="card">
                <h2>Reading Assessment</h2>
                <p>This assessment will evaluate your reading comprehension skills through various passages and questions.</p>
                <p>You will read passages and answer multiple choice questions. The difficulty will adjust based on your performance.</p>
                
                <div class="reading-level">
                    <span>Starting Level:</span>
                    <span class="level-badge">A2</span>
                </div>
                
                <button id="startBtn">Start Reading Assessment</button>
            </div>
        </div>

        <!-- Assessment Interface -->
        <div id="assessment-interface" class="hidden">
            <!-- Progress Display -->
            <div id="progress" class="hidden">
                <!-- Progress will be populated by JavaScript -->
            </div>

            <!-- Reading Passage -->
            <div id="passage" class="hidden">
                <!-- Passage will be populated by JavaScript -->
            </div>

            <!-- Reading Question -->
            <div id="question" class="hidden">
                <!-- Question will be populated by JavaScript -->
            </div>

            <!-- Submit Button -->
            <div class="card">
                <button id="submitBtn" disabled>Submit Answer</button>
            </div>
        </div>

        <!-- Results Display -->
        <div id="results" class="hidden">
            <!-- Results will be populated by JavaScript -->
        </div>

    </div>
</body>
</html>